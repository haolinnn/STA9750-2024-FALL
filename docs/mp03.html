<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>mp03 – STA 9750 2024 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 2024 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="mini-project-03-do-proportional-electoral-college-allocations-yield-a-more-representative-presidency" class="level1">
<h1>Mini-Project #03: Do Proportional Electoral College Allocations Yield a More Representative Presidency?</h1>
<section id="set-up-and-initial-exploration" class="level2">
<h2 class="anchored" data-anchor-id="set-up-and-initial-exploration">Set-Up and Initial Exploration</h2>
</section>
<section id="data-i-us-house-election-votes-from-1976-to-2022" class="level2">
<h2 class="anchored" data-anchor-id="data-i-us-house-election-votes-from-1976-to-2022">Data I: US House Election Votes from 1976 to 2022</h2>
<p>Download data of statewide presidential and house vote counts and house vote counts from 1976 to 2022 from The MIT Election Data Science Lab (https://electionlab.mit.edu/). This data provides detailed House <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> and presidential <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Election voting results for us to analyze the voting pattern with parties and states.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Data I</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># US House</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>csv_file_path <span class="ot">&lt;-</span> <span class="st">"//Users/haolin/Desktop/sta9750/us_house/1976-2022-house.csv"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>house_1976_2022 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(csv_file_path)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># US President</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>csv_file_path <span class="ot">&lt;-</span> <span class="st">"/Users/haolin/Desktop/sta9750/us_president/1976-2020-president.csv"</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>president_1976_2022 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(csv_file_path)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>csv_file_path <span class="ot">&lt;-</span> <span class="st">"/Users/haolin/Desktop/sta9750/us_president/sources-president.csv"</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>sources_president <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(csv_file_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-ii-congressional-boundary-files-1976-to-2012" class="level2">
<h2 class="anchored" data-anchor-id="data-ii-congressional-boundary-files-1976-to-2012">Data II: Congressional Boundary Files 1976 to 2012</h2>
<p>Downloaded congressional shapefiles from Lewis et al.&nbsp;for all US Congresses5 from 1976 to 2012. The data provides boundary definition for US congressional districts.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Data II:</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>congressional_boundary_dir <span class="ot">&lt;-</span> <span class="st">"/Users/haolin/Desktop/sta9750/congressional_boundary"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(congressional_boundary_dir, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to download shapefiles systematically</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>download_congressional_boundary_shapefiles <span class="ot">&lt;-</span> <span class="cf">function</span>(start, end, base_url) {</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (session <span class="cf">in</span> start<span class="sc">:</span>end) {</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    file_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"districts"</span>, <span class="fu">sprintf</span>(<span class="st">"%03d"</span>, session), <span class="st">".zip"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(base_url, file_name)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    destfile <span class="ot">&lt;-</span> <span class="fu">file.path</span>(congressional_boundary_dir, file_name)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(destfile)) {</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">GET</span>(url, <span class="fu">write_disk</span>(destfile, <span class="at">overwrite =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Downloaded:"</span>, file_name))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"File already exists:"</span>, file_name))</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the base URL and download the files</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">"https://cdmaps.polisci.ucla.edu/shp/"</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="fu">download_congressional_boundary_shapefiles</span>(<span class="dv">93</span>, <span class="dv">112</span>, base_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-iii-congressional-boundary-files-2014-to-present" class="level2">
<h2 class="anchored" data-anchor-id="data-iii-congressional-boundary-files-2014-to-present">Data III: Congressional Boundary Files 2014 to Present</h2>
<p>Automatically download congressional shapefiles from the US Census Bureau for all US Congresses from 2014 to 2022. The data contains all legal boundaries and names.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Data III: Congressional Boundary Files 2014 to Present</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create directory for Census shapefiles</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>census_dir <span class="ot">&lt;-</span> <span class="st">"/Users/haolin/Desktop/sta9750/census_congress"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(census_dir, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to download Census shapefiles systematically</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>download_census_shapefiles <span class="ot">&lt;-</span> <span class="cf">function</span>(urls) {</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (url <span class="cf">in</span> urls) {</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    file_name <span class="ot">&lt;-</span> <span class="fu">basename</span>(url)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    destfile <span class="ot">&lt;-</span> <span class="fu">file.path</span>(census_dir, file_name)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Attempt to download the file without error handling</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    response <span class="ot">&lt;-</span> <span class="fu">GET</span>(url, <span class="fu">write_disk</span>(destfile, <span class="at">overwrite =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Define URLs for Census shapefiles</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>census_shapefile_urls <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www2.census.gov/geo/tiger/TIGER2014/CD/tl_2014_us_cd114.zip"</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www2.census.gov/geo/tiger/TIGER2015/CD/tl_2015_us_cd114.zip"</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www2.census.gov/geo/tiger/TIGER2016/CD/tl_2016_us_cd115.zip"</span>,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www2.census.gov/geo/tiger/TIGER2017/CD/tl_2017_us_cd115.zip"</span>,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www2.census.gov/geo/tiger/TIGER2018/CD/tl_2018_us_cd116.zip"</span>,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www2.census.gov/geo/tiger/TIGER2019/CD/tl_2019_us_cd116.zip"</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www2.census.gov/geo/tiger/TIGER2020/CD/tl_2020_us_cd116.zip"</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www2.census.gov/geo/tiger/TIGER2021/CD/tl_2021_us_cd116.zip"</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://www2.census.gov/geo/tiger/TIGER2022/CD/tl_2022_us_cd116.zip"</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Download Census shapefiles</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="fu">download_census_shapefiles</span>(census_shapefile_urls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="initial-exploration-of-vote-count-data" class="level2">
<h2 class="anchored" data-anchor-id="initial-exploration-of-vote-count-data">Initial Exploration of Vote Count Data</h2>
<p>Task 3:<br>
3.1 Which states have gained and lost the most seats in the US House of Representatives between 1976 and 2022?<br>
I filtered the seat counts for year 1976 and year 2000, then merged two data to find the seat changes and selected top 5 states for gain and loses to create the bar chart. According to the bar chart, Taxes gained most seats with net change of 14 seats, following by Florida. New York lost the most seats with differences of 14 seats.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>seat_counts <span class="ot">&lt;-</span> house_1976_2022 <span class="sc">|&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, state) <span class="sc">|&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">seat_count =</span> <span class="fu">n_distinct</span>(district), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter for the years 1976 and 2022</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>seat_counts_1976 <span class="ot">&lt;-</span> seat_counts <span class="sc">|&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">1976</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, seat_count) <span class="sc">|&gt;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">seats_1976 =</span> seat_count)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>seat_counts_2022 <span class="ot">&lt;-</span> seat_counts <span class="sc">|&gt;</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, seat_count) <span class="sc">|&gt;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">seats_2022 =</span> seat_count)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Merge 1976 and 2022 data to compute seat changes</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>seat_changes <span class="ot">&lt;-</span> seat_counts_1976 <span class="sc">|&gt;</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(seat_counts_2022, <span class="at">by =</span> <span class="st">"state"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">seat_change =</span> seats_2022 <span class="sc">-</span> seats_1976) <span class="sc">|&gt;</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(seat_change))</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select top 5 states with most gains and most losses</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>top_gain_loss <span class="ot">&lt;-</span> seat_changes <span class="sc">|&gt;</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, (<span class="fu">n</span>() <span class="sc">-</span> <span class="dv">4</span>)<span class="sc">:</span><span class="fu">n</span>()))</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#graph</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_gain_loss, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(state, seat_change), <span class="at">y =</span> seat_change, <span class="at">fill =</span> seat_change <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> seat_change), </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, </span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"pink"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 5 States with Most Gained and Lost Seats </span><span class="sc">\n</span><span class="st">in the US House (1976 - 2022)"</span>,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"State"</span>, <span class="at">y =</span> <span class="st">"Net Change in Seats"</span>) <span class="sc">+</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>3.2 Are there any elections in our data where the election would have had a different outcome if the “fusion” system was not used and candidates only received the votes their received from their “major party line” (Democrat or Republican) and not their total number of votes across all lines?<br>
</p>
<p>Based on the analysis, NYS’s fusion system can affect election outcomes. By allowing candidates to on multiple “lines” on the ballot and calculating total votes from each line, fusion voting can benefit candidates from smaller parties. When a candidate’s total votes across all parties exceeds the votes of his or her major party, fusion voting can effectively achieve victory, which is unlikely to happen under a single-party voting system.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Filter data for New York State elections</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ny_elections <span class="ot">&lt;-</span> house_1976_2022 <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"NEW YORK"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Identify candidates' major party votes (Democratic or Republican only)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># and their total votes across all lines</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>major_party_votes <span class="ot">&lt;-</span> ny_elections <span class="sc">|&gt;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(party <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DEMOCRAT"</span>, <span class="st">"REPUBLICAN"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year, district, candidate) <span class="sc">|&gt;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">major_party_votes =</span> <span class="fu">sum</span>(candidatevotes), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>total_votes <span class="ot">&lt;-</span> ny_elections <span class="sc">|&gt;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year, district, candidate) <span class="sc">|&gt;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">total_votes =</span> <span class="fu">sum</span>(candidatevotes), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Merge datasets to compare outcomes with and without fusion</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>election_outcomes <span class="ot">&lt;-</span> major_party_votes <span class="sc">|&gt;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(total_votes, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"district"</span>, <span class="st">"candidate"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year, district) <span class="sc">|&gt;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">winner_major_party =</span> candidate[<span class="fu">which.max</span>(major_party_votes)],</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">winner_total_votes =</span> candidate[<span class="fu">which.max</span>(total_votes)],</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">different_outcome =</span> winner_major_party <span class="sc">!=</span> winner_total_votes</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(different_outcome <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the elections where the outcome would differ</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>election_outcomes <span class="sc">|&gt;</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(year, district, candidate, major_party_votes, total_votes, winner_major_party, winner_total_votes, different_outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 8
# Groups:   year, district [22]
    year district candidate     major_party_votes total_votes winner_major_party
   &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                     &lt;int&gt;       &lt;int&gt; &lt;chr&gt;             
 1  1976       29 EDWARD W PAT…             95361      100663 JOSEPH A MARTINO  
 2  1976       29 JOSEPH A MAR…             96476       96476 JOSEPH A MARTINO  
 3  1980        3 GREGORY W CA…             74868       87952 JEROME A AMBRO JR 
 4  1980        3 JEROME A AMB…             75389       83389 JEROME A AMBRO JR 
 5  1980        6 JOHN LEBOUTI…             71838       89762 LESTER L WOLFF    
 6  1980        6 LESTER L WOL…             74319       80209 LESTER L WOLFF    
 7  1984       20 JOSEPH J DIO…             93518      106958 OREN J TEICHER    
 8  1984       20 OREN J TEICH…            102842      102842 OREN J TEICHER    
 9  1986       27 GEORGE C WOR…             77175       83430 ROSEMARY S POOLER 
10  1986       27 ROSEMARY S P…             81133       82491 ROSEMARY S POOLER 
# ℹ 34 more rows
# ℹ 2 more variables: winner_total_votes &lt;chr&gt;, different_outcome &lt;lgl&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>election_outcomes <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Election Outcomes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="euxldvcvyr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#euxldvcvyr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#euxldvcvyr thead, #euxldvcvyr tbody, #euxldvcvyr tfoot, #euxldvcvyr tr, #euxldvcvyr td, #euxldvcvyr th {
  border-style: none;
}

#euxldvcvyr p {
  margin: 0;
  padding: 0;
}

#euxldvcvyr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#euxldvcvyr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#euxldvcvyr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#euxldvcvyr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#euxldvcvyr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#euxldvcvyr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#euxldvcvyr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#euxldvcvyr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#euxldvcvyr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#euxldvcvyr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#euxldvcvyr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#euxldvcvyr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#euxldvcvyr .gt_spanner_row {
  border-bottom-style: hidden;
}

#euxldvcvyr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#euxldvcvyr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#euxldvcvyr .gt_from_md > :first-child {
  margin-top: 0;
}

#euxldvcvyr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#euxldvcvyr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#euxldvcvyr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#euxldvcvyr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#euxldvcvyr .gt_row_group_first td {
  border-top-width: 2px;
}

#euxldvcvyr .gt_row_group_first th {
  border-top-width: 2px;
}

#euxldvcvyr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#euxldvcvyr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#euxldvcvyr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#euxldvcvyr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#euxldvcvyr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#euxldvcvyr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#euxldvcvyr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#euxldvcvyr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#euxldvcvyr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#euxldvcvyr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#euxldvcvyr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#euxldvcvyr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#euxldvcvyr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#euxldvcvyr .gt_left {
  text-align: left;
}

#euxldvcvyr .gt_center {
  text-align: center;
}

#euxldvcvyr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#euxldvcvyr .gt_font_normal {
  font-weight: normal;
}

#euxldvcvyr .gt_font_bold {
  font-weight: bold;
}

#euxldvcvyr .gt_font_italic {
  font-style: italic;
}

#euxldvcvyr .gt_super {
  font-size: 65%;
}

#euxldvcvyr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#euxldvcvyr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#euxldvcvyr .gt_indent_1 {
  text-indent: 5px;
}

#euxldvcvyr .gt_indent_2 {
  text-indent: 10px;
}

#euxldvcvyr .gt_indent_3 {
  text-indent: 15px;
}

#euxldvcvyr .gt_indent_4 {
  text-indent: 20px;
}

#euxldvcvyr .gt_indent_5 {
  text-indent: 25px;
}

#euxldvcvyr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#euxldvcvyr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border">Election Outcomes</th>
</tr>
<tr class="odd gt_col_headings">
<th id="candidate" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">candidate</th>
<th id="major_party_votes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">major_party_votes</th>
<th id="total_votes" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total_votes</th>
<th id="winner_major_party" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">winner_major_party</th>
<th id="winner_total_votes" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">winner_total_votes</th>
<th id="different_outcome" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">different_outcome</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="6" id="1976 - 29" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">1976 - 29</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="1976 - 29  candidate">EDWARD W PATTISON</td>
<td class="gt_row gt_right" headers="1976 - 29  major_party_votes">95361</td>
<td class="gt_row gt_right" headers="1976 - 29  total_votes">100663</td>
<td class="gt_row gt_left" headers="1976 - 29  winner_major_party">JOSEPH A MARTINO</td>
<td class="gt_row gt_left" headers="1976 - 29  winner_total_votes">EDWARD W PATTISON</td>
<td class="gt_row gt_center" headers="1976 - 29  different_outcome">TRUE</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="1976 - 29  candidate">JOSEPH A MARTINO</td>
<td class="gt_row gt_right" headers="1976 - 29  major_party_votes">96476</td>
<td class="gt_row gt_right" headers="1976 - 29  total_votes">96476</td>
<td class="gt_row gt_left" headers="1976 - 29  winner_major_party">JOSEPH A MARTINO</td>
<td class="gt_row gt_left" headers="1976 - 29  winner_total_votes">EDWARD W PATTISON</td>
<td class="gt_row gt_center" headers="1976 - 29  different_outcome">TRUE</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="1980 - 3" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">1980 - 3</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_left" headers="1980 - 3  candidate">GREGORY W CARMAN</td>
<td class="gt_row gt_right" headers="1980 - 3  major_party_votes">74868</td>
<td class="gt_row gt_right" headers="1980 - 3  total_votes">87952</td>
<td class="gt_row gt_left" headers="1980 - 3  winner_major_party">JEROME A AMBRO JR</td>
<td class="gt_row gt_left" headers="1980 - 3  winner_total_votes">GREGORY W CARMAN</td>
<td class="gt_row gt_center" headers="1980 - 3  different_outcome">TRUE</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="1980 - 3  candidate">JEROME A AMBRO JR</td>
<td class="gt_row gt_right" headers="1980 - 3  major_party_votes">75389</td>
<td class="gt_row gt_right" headers="1980 - 3  total_votes">83389</td>
<td class="gt_row gt_left" headers="1980 - 3  winner_major_party">JEROME A AMBRO JR</td>
<td class="gt_row gt_left" headers="1980 - 3  winner_total_votes">GREGORY W CARMAN</td>
<td class="gt_row gt_center" headers="1980 - 3  different_outcome">TRUE</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="1980 - 6" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">1980 - 6</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="1980 - 6  candidate">JOHN LEBOUTILLIER</td>
<td class="gt_row gt_right" headers="1980 - 6  major_party_votes">71838</td>
<td class="gt_row gt_right" headers="1980 - 6  total_votes">89762</td>
<td class="gt_row gt_left" headers="1980 - 6  winner_major_party">LESTER L WOLFF</td>
<td class="gt_row gt_left" headers="1980 - 6  winner_total_votes">JOHN LEBOUTILLIER</td>
<td class="gt_row gt_center" headers="1980 - 6  different_outcome">TRUE</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="1980 - 6  candidate">LESTER L WOLFF</td>
<td class="gt_row gt_right" headers="1980 - 6  major_party_votes">74319</td>
<td class="gt_row gt_right" headers="1980 - 6  total_votes">80209</td>
<td class="gt_row gt_left" headers="1980 - 6  winner_major_party">LESTER L WOLFF</td>
<td class="gt_row gt_left" headers="1980 - 6  winner_total_votes">JOHN LEBOUTILLIER</td>
<td class="gt_row gt_center" headers="1980 - 6  different_outcome">TRUE</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="1984 - 20" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">1984 - 20</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_left" headers="1984 - 20  candidate">JOSEPH J DIOGUARDI</td>
<td class="gt_row gt_right" headers="1984 - 20  major_party_votes">93518</td>
<td class="gt_row gt_right" headers="1984 - 20  total_votes">106958</td>
<td class="gt_row gt_left" headers="1984 - 20  winner_major_party">OREN J TEICHER</td>
<td class="gt_row gt_left" headers="1984 - 20  winner_total_votes">JOSEPH J DIOGUARDI</td>
<td class="gt_row gt_center" headers="1984 - 20  different_outcome">TRUE</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="1984 - 20  candidate">OREN J TEICHER</td>
<td class="gt_row gt_right" headers="1984 - 20  major_party_votes">102842</td>
<td class="gt_row gt_right" headers="1984 - 20  total_votes">102842</td>
<td class="gt_row gt_left" headers="1984 - 20  winner_major_party">OREN J TEICHER</td>
<td class="gt_row gt_left" headers="1984 - 20  winner_total_votes">JOSEPH J DIOGUARDI</td>
<td class="gt_row gt_center" headers="1984 - 20  different_outcome">TRUE</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="1986 - 27" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">1986 - 27</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="1986 - 27  candidate">GEORGE C WORTLEY</td>
<td class="gt_row gt_right" headers="1986 - 27  major_party_votes">77175</td>
<td class="gt_row gt_right" headers="1986 - 27  total_votes">83430</td>
<td class="gt_row gt_left" headers="1986 - 27  winner_major_party">ROSEMARY S POOLER</td>
<td class="gt_row gt_left" headers="1986 - 27  winner_total_votes">GEORGE C WORTLEY</td>
<td class="gt_row gt_center" headers="1986 - 27  different_outcome">TRUE</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="1986 - 27  candidate">ROSEMARY S POOLER</td>
<td class="gt_row gt_right" headers="1986 - 27  major_party_votes">81133</td>
<td class="gt_row gt_right" headers="1986 - 27  total_votes">82491</td>
<td class="gt_row gt_left" headers="1986 - 27  winner_major_party">ROSEMARY S POOLER</td>
<td class="gt_row gt_left" headers="1986 - 27  winner_total_votes">GEORGE C WORTLEY</td>
<td class="gt_row gt_center" headers="1986 - 27  different_outcome">TRUE</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="1992 - 3" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">1992 - 3</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_left" headers="1992 - 3  candidate">PETER T KING</td>
<td class="gt_row gt_right" headers="1992 - 3  major_party_votes">108574</td>
<td class="gt_row gt_right" headers="1992 - 3  total_votes">124727</td>
<td class="gt_row gt_left" headers="1992 - 3  winner_major_party">STEVE A ORLINS</td>
<td class="gt_row gt_left" headers="1992 - 3  winner_total_votes">PETER T KING</td>
<td class="gt_row gt_center" headers="1992 - 3  different_outcome">TRUE</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="1992 - 3  candidate">STEVE A ORLINS</td>
<td class="gt_row gt_right" headers="1992 - 3  major_party_votes">116915</td>
<td class="gt_row gt_right" headers="1992 - 3  total_votes">116915</td>
<td class="gt_row gt_left" headers="1992 - 3  winner_major_party">STEVE A ORLINS</td>
<td class="gt_row gt_left" headers="1992 - 3  winner_total_votes">PETER T KING</td>
<td class="gt_row gt_center" headers="1992 - 3  different_outcome">TRUE</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="1994 - 1" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">1994 - 1</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="1994 - 1  candidate">GEORGE J HOCHBRUECKNER</td>
<td class="gt_row gt_right" headers="1994 - 1  major_party_votes">78692</td>
<td class="gt_row gt_right" headers="1994 - 1  total_votes">80146</td>
<td class="gt_row gt_left" headers="1994 - 1  winner_major_party">GEORGE J HOCHBRUECKNER</td>
<td class="gt_row gt_left" headers="1994 - 1  winner_total_votes">MICHAEL P FORBES</td>
<td class="gt_row gt_center" headers="1994 - 1  different_outcome">TRUE</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="1994 - 1  candidate">MICHAEL P FORBES</td>
<td class="gt_row gt_right" headers="1994 - 1  major_party_votes">72045</td>
<td class="gt_row gt_right" headers="1994 - 1  total_votes">90491</td>
<td class="gt_row gt_left" headers="1994 - 1  winner_major_party">GEORGE J HOCHBRUECKNER</td>
<td class="gt_row gt_left" headers="1994 - 1  winner_total_votes">MICHAEL P FORBES</td>
<td class="gt_row gt_center" headers="1994 - 1  different_outcome">TRUE</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="1996 - 1" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">1996 - 1</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_left" headers="1996 - 1  candidate">MICHAEL P FORBES</td>
<td class="gt_row gt_right" headers="1996 - 1  major_party_votes">90001</td>
<td class="gt_row gt_right" headers="1996 - 1  total_votes">116620</td>
<td class="gt_row gt_left" headers="1996 - 1  winner_major_party">NORA L BREDES</td>
<td class="gt_row gt_left" headers="1996 - 1  winner_total_votes">MICHAEL P FORBES</td>
<td class="gt_row gt_center" headers="1996 - 1  different_outcome">TRUE</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="1996 - 1  candidate">NORA L BREDES</td>
<td class="gt_row gt_right" headers="1996 - 1  major_party_votes">93816</td>
<td class="gt_row gt_right" headers="1996 - 1  total_votes">96496</td>
<td class="gt_row gt_left" headers="1996 - 1  winner_major_party">NORA L BREDES</td>
<td class="gt_row gt_left" headers="1996 - 1  winner_total_votes">MICHAEL P FORBES</td>
<td class="gt_row gt_center" headers="1996 - 1  different_outcome">TRUE</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="1996 - 30" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">1996 - 30</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="1996 - 30  candidate">FRANCIS J PORDUM</td>
<td class="gt_row gt_right" headers="1996 - 30  major_party_votes">97686</td>
<td class="gt_row gt_right" headers="1996 - 30  total_votes">100040</td>
<td class="gt_row gt_left" headers="1996 - 30  winner_major_party">FRANCIS J PORDUM</td>
<td class="gt_row gt_left" headers="1996 - 30  winner_total_votes">JACK QUINN</td>
<td class="gt_row gt_center" headers="1996 - 30  different_outcome">TRUE</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="1996 - 30  candidate">JACK QUINN</td>
<td class="gt_row gt_right" headers="1996 - 30  major_party_votes">97320</td>
<td class="gt_row gt_right" headers="1996 - 30  total_votes">121369</td>
<td class="gt_row gt_left" headers="1996 - 30  winner_major_party">FRANCIS J PORDUM</td>
<td class="gt_row gt_left" headers="1996 - 30  winner_total_votes">JACK QUINN</td>
<td class="gt_row gt_center" headers="1996 - 30  different_outcome">TRUE</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="2006 - 25" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">2006 - 25</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_left" headers="2006 - 25  candidate">DAN MAFFEI</td>
<td class="gt_row gt_right" headers="2006 - 25  major_party_votes">100605</td>
<td class="gt_row gt_right" headers="2006 - 25  total_votes">107108</td>
<td class="gt_row gt_left" headers="2006 - 25  winner_major_party">DAN MAFFEI</td>
<td class="gt_row gt_left" headers="2006 - 25  winner_total_votes">JAMES T WALSH</td>
<td class="gt_row gt_center" headers="2006 - 25  different_outcome">TRUE</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="2006 - 25  candidate">JAMES T WALSH</td>
<td class="gt_row gt_right" headers="2006 - 25  major_party_votes">91187</td>
<td class="gt_row gt_right" headers="2006 - 25  total_votes">110525</td>
<td class="gt_row gt_left" headers="2006 - 25  winner_major_party">DAN MAFFEI</td>
<td class="gt_row gt_left" headers="2006 - 25  winner_total_votes">JAMES T WALSH</td>
<td class="gt_row gt_center" headers="2006 - 25  different_outcome">TRUE</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="2006 - 29" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">2006 - 29</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="2006 - 29  candidate">ERIC J MASSA</td>
<td class="gt_row gt_right" headers="2006 - 29  major_party_votes">94609</td>
<td class="gt_row gt_right" headers="2006 - 29  total_votes">100044</td>
<td class="gt_row gt_left" headers="2006 - 29  winner_major_party">ERIC J MASSA</td>
<td class="gt_row gt_left" headers="2006 - 29  winner_total_votes">JOHN R "RANDY" KUHL JR</td>
<td class="gt_row gt_center" headers="2006 - 29  different_outcome">TRUE</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="2006 - 29  candidate">JOHN R "RANDY" KUHL JR</td>
<td class="gt_row gt_right" headers="2006 - 29  major_party_votes">91383</td>
<td class="gt_row gt_right" headers="2006 - 29  total_votes">106077</td>
<td class="gt_row gt_left" headers="2006 - 29  winner_major_party">ERIC J MASSA</td>
<td class="gt_row gt_left" headers="2006 - 29  winner_total_votes">JOHN R "RANDY" KUHL JR</td>
<td class="gt_row gt_center" headers="2006 - 29  different_outcome">TRUE</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="2010 - 13" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">2010 - 13</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_left" headers="2010 - 13  candidate">MICHAEL E MCMAHON</td>
<td class="gt_row gt_right" headers="2010 - 13  major_party_votes">60773</td>
<td class="gt_row gt_right" headers="2010 - 13  total_votes">60773</td>
<td class="gt_row gt_left" headers="2010 - 13  winner_major_party">MICHAEL E MCMAHON</td>
<td class="gt_row gt_left" headers="2010 - 13  winner_total_votes">MICHAEL G GRIMM</td>
<td class="gt_row gt_center" headers="2010 - 13  different_outcome">TRUE</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="2010 - 13  candidate">MICHAEL G GRIMM</td>
<td class="gt_row gt_right" headers="2010 - 13  major_party_votes">55821</td>
<td class="gt_row gt_right" headers="2010 - 13  total_votes">65024</td>
<td class="gt_row gt_left" headers="2010 - 13  winner_major_party">MICHAEL E MCMAHON</td>
<td class="gt_row gt_left" headers="2010 - 13  winner_total_votes">MICHAEL G GRIMM</td>
<td class="gt_row gt_center" headers="2010 - 13  different_outcome">TRUE</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="2010 - 19" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">2010 - 19</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="2010 - 19  candidate">JOHN J HALL</td>
<td class="gt_row gt_right" headers="2010 - 19  major_party_votes">98766</td>
<td class="gt_row gt_right" headers="2010 - 19  total_votes">98766</td>
<td class="gt_row gt_left" headers="2010 - 19  winner_major_party">JOHN J HALL</td>
<td class="gt_row gt_left" headers="2010 - 19  winner_total_votes">NAN HAYMORTH</td>
<td class="gt_row gt_center" headers="2010 - 19  different_outcome">TRUE</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="2010 - 19  candidate">NAN HAYMORTH</td>
<td class="gt_row gt_right" headers="2010 - 19  major_party_votes">88734</td>
<td class="gt_row gt_right" headers="2010 - 19  total_votes">109956</td>
<td class="gt_row gt_left" headers="2010 - 19  winner_major_party">JOHN J HALL</td>
<td class="gt_row gt_left" headers="2010 - 19  winner_total_votes">NAN HAYMORTH</td>
<td class="gt_row gt_center" headers="2010 - 19  different_outcome">TRUE</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="2010 - 24" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">2010 - 24</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_left" headers="2010 - 24  candidate">MICHAEL A ARCURI</td>
<td class="gt_row gt_right" headers="2010 - 24  major_party_votes">89809</td>
<td class="gt_row gt_right" headers="2010 - 24  total_votes">89809</td>
<td class="gt_row gt_left" headers="2010 - 24  winner_major_party">MICHAEL A ARCURI</td>
<td class="gt_row gt_left" headers="2010 - 24  winner_total_votes">RICHARD L HANNA</td>
<td class="gt_row gt_center" headers="2010 - 24  different_outcome">TRUE</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="2010 - 24  candidate">RICHARD L HANNA</td>
<td class="gt_row gt_right" headers="2010 - 24  major_party_votes">85702</td>
<td class="gt_row gt_right" headers="2010 - 24  total_votes">101599</td>
<td class="gt_row gt_left" headers="2010 - 24  winner_major_party">MICHAEL A ARCURI</td>
<td class="gt_row gt_left" headers="2010 - 24  winner_total_votes">RICHARD L HANNA</td>
<td class="gt_row gt_center" headers="2010 - 24  different_outcome">TRUE</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="2010 - 25" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">2010 - 25</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="2010 - 25  candidate">ANN MARIE BUERKLE</td>
<td class="gt_row gt_right" headers="2010 - 25  major_party_votes">81380</td>
<td class="gt_row gt_right" headers="2010 - 25  total_votes">104602</td>
<td class="gt_row gt_left" headers="2010 - 25  winner_major_party">DANIEL B MAFFEI</td>
<td class="gt_row gt_left" headers="2010 - 25  winner_total_votes">ANN MARIE BUERKLE</td>
<td class="gt_row gt_center" headers="2010 - 25  different_outcome">TRUE</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="2010 - 25  candidate">DANIEL B MAFFEI</td>
<td class="gt_row gt_right" headers="2010 - 25  major_party_votes">103954</td>
<td class="gt_row gt_right" headers="2010 - 25  total_votes">103954</td>
<td class="gt_row gt_left" headers="2010 - 25  winner_major_party">DANIEL B MAFFEI</td>
<td class="gt_row gt_left" headers="2010 - 25  winner_total_votes">ANN MARIE BUERKLE</td>
<td class="gt_row gt_center" headers="2010 - 25  different_outcome">TRUE</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="2012 - 27" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">2012 - 27</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_left" headers="2012 - 27  candidate">CHRIS COLLINS</td>
<td class="gt_row gt_right" headers="2012 - 27  major_party_votes">137250</td>
<td class="gt_row gt_right" headers="2012 - 27  total_votes">161220</td>
<td class="gt_row gt_left" headers="2012 - 27  winner_major_party">KATHLEEN C HOCHUL</td>
<td class="gt_row gt_left" headers="2012 - 27  winner_total_votes">CHRIS COLLINS</td>
<td class="gt_row gt_center" headers="2012 - 27  different_outcome">TRUE</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="2012 - 27  candidate">KATHLEEN C HOCHUL</td>
<td class="gt_row gt_right" headers="2012 - 27  major_party_votes">140008</td>
<td class="gt_row gt_right" headers="2012 - 27  total_votes">156219</td>
<td class="gt_row gt_left" headers="2012 - 27  winner_major_party">KATHLEEN C HOCHUL</td>
<td class="gt_row gt_left" headers="2012 - 27  winner_total_votes">CHRIS COLLINS</td>
<td class="gt_row gt_center" headers="2012 - 27  different_outcome">TRUE</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="2018 - 1" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">2018 - 1</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="2018 - 1  candidate">LEE M ZELDIN</td>
<td class="gt_row gt_right" headers="2018 - 1  major_party_votes">121562</td>
<td class="gt_row gt_right" headers="2018 - 1  total_votes">139027</td>
<td class="gt_row gt_left" headers="2018 - 1  winner_major_party">PERRY GERSHON</td>
<td class="gt_row gt_left" headers="2018 - 1  winner_total_votes">LEE M ZELDIN</td>
<td class="gt_row gt_center" headers="2018 - 1  different_outcome">TRUE</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="2018 - 1  candidate">PERRY GERSHON</td>
<td class="gt_row gt_right" headers="2018 - 1  major_party_votes">124213</td>
<td class="gt_row gt_right" headers="2018 - 1  total_votes">127991</td>
<td class="gt_row gt_left" headers="2018 - 1  winner_major_party">PERRY GERSHON</td>
<td class="gt_row gt_left" headers="2018 - 1  winner_total_votes">LEE M ZELDIN</td>
<td class="gt_row gt_center" headers="2018 - 1  different_outcome">TRUE</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="2018 - 24" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">2018 - 24</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_left" headers="2018 - 24  candidate">DANA BALTER</td>
<td class="gt_row gt_right" headers="2018 - 24  major_party_votes">115902</td>
<td class="gt_row gt_right" headers="2018 - 24  total_votes">123226</td>
<td class="gt_row gt_left" headers="2018 - 24  winner_major_party">DANA BALTER</td>
<td class="gt_row gt_left" headers="2018 - 24  winner_total_votes">JOHN M KATKO</td>
<td class="gt_row gt_center" headers="2018 - 24  different_outcome">TRUE</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="2018 - 24  candidate">JOHN M KATKO</td>
<td class="gt_row gt_right" headers="2018 - 24  major_party_votes">113538</td>
<td class="gt_row gt_right" headers="2018 - 24  total_votes">136920</td>
<td class="gt_row gt_left" headers="2018 - 24  winner_major_party">DANA BALTER</td>
<td class="gt_row gt_left" headers="2018 - 24  winner_total_votes">JOHN M KATKO</td>
<td class="gt_row gt_center" headers="2018 - 24  different_outcome">TRUE</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="2018 - 27" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">2018 - 27</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="2018 - 27  candidate">CHRIS COLLINS</td>
<td class="gt_row gt_right" headers="2018 - 27  major_party_votes">114506</td>
<td class="gt_row gt_right" headers="2018 - 27  total_votes">140146</td>
<td class="gt_row gt_left" headers="2018 - 27  winner_major_party">NATHAN D MCMURRAY</td>
<td class="gt_row gt_left" headers="2018 - 27  winner_total_votes">CHRIS COLLINS</td>
<td class="gt_row gt_center" headers="2018 - 27  different_outcome">TRUE</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="2018 - 27  candidate">NATHAN D MCMURRAY</td>
<td class="gt_row gt_right" headers="2018 - 27  major_party_votes">128167</td>
<td class="gt_row gt_right" headers="2018 - 27  total_votes">139059</td>
<td class="gt_row gt_left" headers="2018 - 27  winner_major_party">NATHAN D MCMURRAY</td>
<td class="gt_row gt_left" headers="2018 - 27  winner_total_votes">CHRIS COLLINS</td>
<td class="gt_row gt_center" headers="2018 - 27  different_outcome">TRUE</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="2022 - 4" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">2022 - 4</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_left" headers="2022 - 4  candidate">ANTHONY P D’ESPOSITO</td>
<td class="gt_row gt_right" headers="2022 - 4  major_party_votes">129353</td>
<td class="gt_row gt_right" headers="2022 - 4  total_votes">140622</td>
<td class="gt_row gt_left" headers="2022 - 4  winner_major_party">LAURA A GILLEN</td>
<td class="gt_row gt_left" headers="2022 - 4  winner_total_votes">ANTHONY P D’ESPOSITO</td>
<td class="gt_row gt_center" headers="2022 - 4  different_outcome">TRUE</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="2022 - 4  candidate">LAURA A GILLEN</td>
<td class="gt_row gt_right" headers="2022 - 4  major_party_votes">130871</td>
<td class="gt_row gt_right" headers="2022 - 4  total_votes">130871</td>
<td class="gt_row gt_left" headers="2022 - 4  winner_major_party">LAURA A GILLEN</td>
<td class="gt_row gt_left" headers="2022 - 4  winner_total_votes">ANTHONY P D’ESPOSITO</td>
<td class="gt_row gt_center" headers="2022 - 4  different_outcome">TRUE</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="6" id="2022 - 17" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">2022 - 17</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="2022 - 17  candidate">MICHAEL V LAWLER</td>
<td class="gt_row gt_right" headers="2022 - 17  major_party_votes">125738</td>
<td class="gt_row gt_right" headers="2022 - 17  total_votes">143550</td>
<td class="gt_row gt_left" headers="2022 - 17  winner_major_party">SEAN PATRICK MALONEY</td>
<td class="gt_row gt_left" headers="2022 - 17  winner_total_votes">MICHAEL V LAWLER</td>
<td class="gt_row gt_center" headers="2022 - 17  different_outcome">TRUE</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="2022 - 17  candidate">SEAN PATRICK MALONEY</td>
<td class="gt_row gt_right" headers="2022 - 17  major_party_votes">133457</td>
<td class="gt_row gt_right" headers="2022 - 17  total_votes">141730</td>
<td class="gt_row gt_left" headers="2022 - 17  winner_major_party">SEAN PATRICK MALONEY</td>
<td class="gt_row gt_left" headers="2022 - 17  winner_total_votes">MICHAEL V LAWLER</td>
<td class="gt_row gt_center" headers="2022 - 17  different_outcome">TRUE</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="2022 - 22" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">2022 - 22</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_left" headers="2022 - 22  candidate">BRANDON M WILLIAMS</td>
<td class="gt_row gt_right" headers="2022 - 22  major_party_votes">116529</td>
<td class="gt_row gt_right" headers="2022 - 22  total_votes">135544</td>
<td class="gt_row gt_left" headers="2022 - 22  winner_major_party">FRANCIS CONOLE</td>
<td class="gt_row gt_left" headers="2022 - 22  winner_total_votes">BRANDON M WILLIAMS</td>
<td class="gt_row gt_center" headers="2022 - 22  different_outcome">TRUE</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="2022 - 22  candidate">FRANCIS CONOLE</td>
<td class="gt_row gt_right" headers="2022 - 22  major_party_votes">132913</td>
<td class="gt_row gt_right" headers="2022 - 22  total_votes">132913</td>
<td class="gt_row gt_left" headers="2022 - 22  winner_major_party">FRANCIS CONOLE</td>
<td class="gt_row gt_left" headers="2022 - 22  winner_total_votes">BRANDON M WILLIAMS</td>
<td class="gt_row gt_center" headers="2022 - 22  different_outcome">TRUE</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>3.3 Do presidential candidates tend to run ahead of or run behind congressional candidates in the same state? That is, does a Democratic candidate for president tend to get more votes in a given state than all Democratic congressional candidates in the same state?<br>
– By calculating average votes differences of presidential candidates and congressional candidates for each state,it shows that no matter democratic or republican, congressional candidates tends to get more votes in the same states.<br>
</p>
<p>Does this trend differ over time?<br>
– It may differ over time. Based on the line graph of “Average Vote Difference Over Time”, during 1980s and 1990s, they have more differences, but some time on 1990s and 2000-2010, they have less differences.<br>
</p>
<p>Does it differ across states or across parties? Are any presidents particularly more or less popular than their co-partisans?<br>
– It differ across the states. Based on the graph, in some states like FL, congressional condidates ten to get more votes, but in MA, presidential candidates tend to get more votes. But the differ across the states are not obviously as differ across parties. Especially Republican party, they tend to get more votes as presidential candidates.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filter house data for democratic and republican</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>house_votes <span class="ot">&lt;-</span> house_1976_2022 <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(party <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DEMOCRAT"</span>, <span class="st">"REPUBLICAN"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year, state, party) <span class="sc">|&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">total_votes =</span> <span class="fu">sum</span>(candidatevotes), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter Presidential data for Democratic and Republican candidates</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>president_votes <span class="ot">&lt;-</span> president_1976_2022 <span class="sc">|&gt;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(party_simplified <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DEMOCRAT"</span>, <span class="st">"REPUBLICAN"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year, state, <span class="at">party =</span> party_simplified) <span class="sc">|&gt;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">total_votes =</span> <span class="fu">sum</span>(candidatevotes), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge House and Presidential votes by year, state, and party</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>house_presidential_votes <span class="ot">&lt;-</span> house_votes <span class="sc">|&gt;</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(president_votes, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"state"</span>, <span class="st">"party"</span>), <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_house"</span>, <span class="st">"_president"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">vote_diff =</span> total_votes_president <span class="sc">-</span> total_votes_house)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average vote difference by year and party to examine trends over time</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>votes_trend_time <span class="ot">&lt;-</span> house_presidential_votes <span class="sc">|&gt;</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year, party) <span class="sc">|&gt;</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">avg_vote_diff =</span> <span class="fu">mean</span>(vote_diff), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average vote difference by state and party to examine trends across states</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>votes_states <span class="ot">&lt;-</span> house_presidential_votes <span class="sc">|&gt;</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(state, party) <span class="sc">|&gt;</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">avg_vote_diff =</span> <span class="fu">mean</span>(vote_diff), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trends over time</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(votes_trend_time, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> avg_vote_diff, <span class="at">color =</span> party)) <span class="sc">+</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Vote Difference Over Time (President vs. Congressional Candidates)"</span>,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Average Vote Difference (President - House)"</span>,</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"Party"</span>) <span class="sc">+</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot trends across states</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(votes_states, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(state, avg_vote_diff), <span class="at">y =</span> avg_vote_diff, <span class="at">fill =</span> party)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Vote Difference Across States (President vs. Congressional Candidates)"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"State"</span>, <span class="at">y =</span> <span class="st">"Average Vote Difference (President - House)"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"Party"</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="importing-and-plotting-shape-file-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-and-plotting-shape-file-data">Importing and Plotting Shape File Data</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing and Plotting Shape File Data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"nyc_borough_boundaries.zip"</span>)){</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">download.file</span>(<span class="st">"https://data.cityofnewyork.us/api/geospatial/tqmj-j8zm?method=export&amp;format=Shapefile"</span>, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">destfile=</span><span class="st">"nyc_borough_boundaries.zip"</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="do">##-</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>td <span class="ot">&lt;-</span> <span class="fu">tempdir</span>(); </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>zip_contents <span class="ot">&lt;-</span> <span class="fu">unzip</span>(<span class="st">"nyc_borough_boundaries.zip"</span>, </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">exdir =</span> td)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>fname_shp <span class="ot">&lt;-</span> zip_contents[<span class="fu">grepl</span>(<span class="st">"shp$"</span>, zip_contents)]</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>nyc_sf <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(fname_shp)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>nyc_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 4 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -74.25559 ymin: 40.49613 xmax: -73.70001 ymax: 40.91553
Geodetic CRS:  WGS84(DD)
# A tibble: 5 × 5
  boro_code boro_name      shape_area shape_leng                        geometry
      &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;      &lt;dbl&gt;              &lt;MULTIPOLYGON [°]&gt;
1         3 Brooklyn      1934142776.    728147. (((-73.86327 40.58388, -73.863…
2         5 Staten Island 1623618684.    325910. (((-74.05051 40.56642, -74.050…
3         1 Manhattan      636646082.    360038. (((-74.01093 40.68449, -74.011…
4         2 Bronx         1187174772.    463181. (((-73.89681 40.79581, -73.896…
5         4 Queens        3041418004.    888197. (((-73.82645 40.59053, -73.826…</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Task 4:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show the code"</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to read specific Census shapefiles into R</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>read_census_shapefiles <span class="ot">&lt;-</span> <span class="cf">function</span>(directory, filenames) {</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  shapefiles <span class="ot">&lt;-</span> <span class="fu">list.files</span>(directory, <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">.zip$"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (zip_file <span class="cf">in</span> shapefiles) {</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    unzip_dir <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unzip</span>(zip_file, <span class="at">exdir =</span> unzip_dir)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    shp_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(unzip_dir, <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">.shp$"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (shp_file <span class="cf">in</span> shp_files) {</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if the shapefile matches the desired filenames</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">basename</span>(shp_file) <span class="sc">%in%</span> filenames) {</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Attempt to read the shapefile without error handling</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>        sf_object <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(shp_file, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>        results[[<span class="fu">basename</span>(shp_file)]] <span class="ot">&lt;-</span> sf_object</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="co"># List of specific filenames to read</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>desired_filenames <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tl_2014_us_cd114.shp"</span>,</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tl_2015_us_cd114.shp"</span>,</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tl_2016_us_cd115.shp"</span>,</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tl_2017_us_cd115.shp"</span>,</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tl_2018_us_cd116.shp"</span>,</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tl_2019_us_cd116.shp"</span>,</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tl_2020_us_cd116.shp"</span>,</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tl_2021_us_cd116.shp"</span>,</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tl_2022_us_cd116.shp"</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the downloaded Census shapefiles into R</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>census_shapefiles <span class="ot">&lt;-</span> <span class="fu">read_census_shapefiles</span>(census_dir, desired_filenames)</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="co"># UCLA file</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to read UCLA shapefiles into R</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>read_congressional_boundary_shapefiles <span class="ot">&lt;-</span> <span class="cf">function</span>(directory) {</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>  shapefiles <span class="ot">&lt;-</span> <span class="fu">list.files</span>(directory, <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">.zip$"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (zip_file <span class="cf">in</span> shapefiles) {</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>    unzip_dir <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unzip</span>(zip_file, <span class="at">exdir =</span> unzip_dir)</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>    shp_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(unzip_dir, <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">.shp$"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (shp_file <span class="cf">in</span> shp_files) {</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Attempt to read the shapefile without error handling</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>      sf_object <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(shp_file, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>      results[[<span class="fu">basename</span>(shp_file)]] <span class="ot">&lt;-</span> sf_object</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the downloaded UCLA shapefiles into R</span></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>congressional_boundary_shapefiles <span class="ot">&lt;-</span> <span class="co"># Function to read UCLA shapefiles into R</span></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a><span class="fu">read_congressional_boundary_shapefiles</span>(congressional_boundary_dir)</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a><span class="co">#st of GPS coordinates which outline a spatial region.</span></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nyc_sf, </span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">geometry=</span>geometry)) <span class="sc">+</span> </span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nyc_sf, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">geometry=</span>geometry, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> shape_area)) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="task-5-chloropleth-visualization-of-the-2000-presidential-election-electoral-college-results" class="level2">
<h2 class="anchored" data-anchor-id="task-5-chloropleth-visualization-of-the-2000-presidential-election-electoral-college-results">Task 5: Chloropleth Visualization of the 2000 Presidential Election Electoral College Results</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"maps"</span>, <span class="at">repos =</span> <span class="st">"https://cloud.r-project.org/"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/bq/05hlr9wx4v77q56gl3760zf40000gn/T//RtmpNnwCVd/downloaded_packages</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct path for reading the shapefile directly from the zip</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>district106_path <span class="ot">&lt;-</span> <span class="st">"/Users/haolin/Desktop/sta9750/congressional_boundary/district106Shapes/districts106.shp"</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>district106 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(district106_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `districts106' from data source 
  `/Users/haolin/Desktop/sta9750/congressional_boundary/district106Shapes/districts106.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 436 features and 15 fields (with 1 geometry empty)
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -179.1473 ymin: 18.9177 xmax: 179.7785 ymax: 71.35256
Geodetic CRS:  GRS 1980(IUGG, 1980)</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create electoral college votes column</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>district106 <span class="ot">&lt;-</span> district106 <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">STATENAME =</span> <span class="fu">tolower</span>(STATENAME)) <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>geometry) <span class="sc">|&gt;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(STATENAME) <span class="sc">|&gt;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>( <span class="at">EC =</span> <span class="fu">n</span>() <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># show winning party for each state</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>president_2000 <span class="ot">&lt;-</span> president_1976_2022 <span class="sc">|&gt;</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2000</span>, party_detailed <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DEMOCRAT"</span>, <span class="st">"REPUBLICAN"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state, party_detailed) <span class="sc">|&gt;</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_votes =</span> <span class="fu">sum</span>(candidatevotes), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>vote_results_2000 <span class="ot">&lt;-</span> president_2000 <span class="sc">|&gt;</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">tolower</span>(state)) <span class="sc">|&gt;</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">winning_party =</span> party_detailed[<span class="fu">which.max</span>(total_votes)]) <span class="sc">|&gt;</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(total_votes, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co"># the Winning Party for Each State</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>winners_2000 <span class="ot">&lt;-</span> president_2000 <span class="sc">|&gt;</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(total_votes <span class="sc">==</span> <span class="fu">max</span>(total_votes)) <span class="sc">|&gt;</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">winning_party =</span> <span class="fu">first</span>(party_detailed), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Load U.S. States Map Data</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>states_map <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(maps<span class="sc">::</span><span class="fu">map</span>(<span class="st">"state"</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>))</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>winners_2000 <span class="ot">&lt;-</span> winners_2000 <span class="sc">|&gt;</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">tolower</span>(state))  </span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>states_map <span class="ot">&lt;-</span> states_map <span class="sc">|&gt;</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">tolower</span>(ID)) </span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the Winning Party and Map Data</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>map_data <span class="ot">&lt;-</span> states_map <span class="sc">|&gt;</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(winners_2000, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ID"</span> <span class="ot">=</span> <span class="st">"state"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(district106, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ID"</span> <span class="ot">=</span> <span class="st">"STATENAME"</span>))</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>map_data <span class="ot">&lt;-</span> map_data <span class="sc">|&gt;</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">states_abb =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"alabama"</span> <span class="sc">~</span> <span class="st">"AL"</span>,</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"arizona"</span> <span class="sc">~</span> <span class="st">"AZ"</span>,</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"arkansas"</span> <span class="sc">~</span> <span class="st">"AR"</span>,</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"california"</span> <span class="sc">~</span> <span class="st">"CA"</span>,</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"colorado"</span> <span class="sc">~</span> <span class="st">"CO"</span>,</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"connecticut"</span> <span class="sc">~</span> <span class="st">"CT"</span>,</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"delaware"</span> <span class="sc">~</span> <span class="st">"DE"</span>,</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"district of columbia"</span> <span class="sc">~</span> <span class="st">"DC"</span>,</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"florida"</span> <span class="sc">~</span> <span class="st">"FL"</span>,</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"georgia"</span> <span class="sc">~</span> <span class="st">"GA"</span>,</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"idaho"</span> <span class="sc">~</span> <span class="st">"ID"</span>,</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"illinois"</span> <span class="sc">~</span> <span class="st">"IL"</span>,</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"indiana"</span> <span class="sc">~</span> <span class="st">"IN"</span>,</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"iowa"</span> <span class="sc">~</span> <span class="st">"IA"</span>,</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"kansas"</span> <span class="sc">~</span> <span class="st">"KS"</span>,</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"kentucky"</span> <span class="sc">~</span> <span class="st">"KY"</span>,</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"louisiana"</span> <span class="sc">~</span> <span class="st">"LA"</span>,</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"maine"</span> <span class="sc">~</span> <span class="st">"ME"</span>,</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"maryland"</span> <span class="sc">~</span> <span class="st">"MD"</span>,</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"massachusetts"</span> <span class="sc">~</span> <span class="st">"MA"</span>,</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"michigan"</span> <span class="sc">~</span> <span class="st">"MI"</span>,</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"minnesota"</span> <span class="sc">~</span> <span class="st">"MN"</span>,</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"mississippi"</span> <span class="sc">~</span> <span class="st">"MS"</span>,</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"missouri"</span> <span class="sc">~</span> <span class="st">"MO"</span>,</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"montana"</span> <span class="sc">~</span> <span class="st">"MT"</span>,</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"nebraska"</span> <span class="sc">~</span> <span class="st">"NE"</span>,</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"nevada"</span> <span class="sc">~</span> <span class="st">"NV"</span>,</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"new hampshire"</span> <span class="sc">~</span> <span class="st">"NH"</span>,</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"new jersey"</span> <span class="sc">~</span> <span class="st">"NJ"</span>,</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"new mexico"</span> <span class="sc">~</span> <span class="st">"NM"</span>,</span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"new york"</span> <span class="sc">~</span> <span class="st">"NY"</span>,</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"north carolina"</span> <span class="sc">~</span> <span class="st">"NC"</span>,</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"north dakota"</span> <span class="sc">~</span> <span class="st">"ND"</span>,</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"ohio"</span> <span class="sc">~</span> <span class="st">"OH"</span>,</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"oklahoma"</span> <span class="sc">~</span> <span class="st">"OK"</span>,</span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"oregon"</span> <span class="sc">~</span> <span class="st">"OR"</span>,</span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"pennsylvania"</span> <span class="sc">~</span> <span class="st">"PA"</span>,</span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"rhode island"</span> <span class="sc">~</span> <span class="st">"RI"</span>,</span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"south carolina"</span> <span class="sc">~</span> <span class="st">"SC"</span>,</span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"south dakota"</span> <span class="sc">~</span> <span class="st">"SD"</span>,</span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"tennessee"</span> <span class="sc">~</span> <span class="st">"TN"</span>,</span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"texas"</span> <span class="sc">~</span> <span class="st">"TX"</span>,</span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"utah"</span> <span class="sc">~</span> <span class="st">"UT"</span>,</span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"vermont"</span> <span class="sc">~</span> <span class="st">"VT"</span>,</span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"virginia"</span> <span class="sc">~</span> <span class="st">"VA"</span>,</span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"washington"</span> <span class="sc">~</span> <span class="st">"WA"</span>,</span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"west virginia"</span> <span class="sc">~</span> <span class="st">"WV"</span>,</span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"wisconsin"</span> <span class="sc">~</span> <span class="st">"WI"</span>,</span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>    ID <span class="sc">==</span> <span class="st">"wyoming"</span> <span class="sc">~</span> <span class="st">"WY"</span>,</span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>  <span class="co"># In case of missing values, set to NA</span></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>base_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> map_data) <span class="sc">+</span></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> winning_party), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Fill states based on winning party</span></span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"DEMOCRAT"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"REPUBLICAN"</span> <span class="ot">=</span> <span class="st">"red"</span>),</span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"DEMOCRAT"</span> <span class="ot">=</span> <span class="st">"Gore"</span>, <span class="st">"REPUBLICAN"</span> <span class="ot">=</span> <span class="st">"Bush"</span>),</span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">"Winning Party"</span>) <span class="sc">+</span></span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> EC), </span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">nudge_y =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  </span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"2000 Presidential Election Results by State"</span>,</span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Bush vs. Gore"</span>,</span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(base_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="task-6-electoral-college-results-over-time" class="level2">
<h2 class="anchored" data-anchor-id="task-6-electoral-college-results-over-time">Task 6: Electoral College Results Over Time</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plot_election_map <span class="ot">&lt;-</span> <span class="cf">function</span>(election_year, shapefile_key) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#districts </span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  districts <span class="ot">&lt;-</span> congressional_boundary_shapefiles[[shapefile_key]]</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Create electoral college votes column</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  districts_EC <span class="ot">&lt;-</span> districts <span class="sc">|&gt;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">STATENAME =</span> <span class="fu">toupper</span>(STATENAME)) <span class="sc">|&gt;</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>geometry) <span class="sc">|&gt;</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(STATENAME) <span class="sc">|&gt;</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">EC =</span> <span class="fu">n</span>() <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#year and the winning party per state</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  election_data <span class="ot">&lt;-</span> president_1976_2022 <span class="sc">|&gt;</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> election_year) <span class="sc">|&gt;</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">winning_party =</span> party_simplified[<span class="fu">which.max</span>(candidatevotes)]) <span class="sc">|&gt;</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(candidatevotes, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  election_EC <span class="ot">&lt;-</span> districts_EC <span class="sc">|&gt;</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(election_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"STATENAME"</span> <span class="ot">=</span> <span class="st">"state"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">state =</span> STATENAME, EC, winning_party, state_fips)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Import shapefiles for states</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"usmap"</span>, <span class="at">repos =</span> <span class="st">"https://cloud.r-project.org/"</span>)</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  us_state_shapefiles <span class="ot">&lt;-</span> usmap<span class="sc">::</span><span class="fu">us_map</span>(<span class="at">regions =</span> <span class="st">"states"</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fips =</span> <span class="fu">as.integer</span>(fips))</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#join between election data and state shapefiles</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  election_states <span class="ot">&lt;-</span> election_EC <span class="sc">|&gt;</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(us_state_shapefiles, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state_fips"</span> <span class="ot">=</span> <span class="st">"fips"</span>))</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Ensure merged data is a valid sf object</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  election_states_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(election_states)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Plot the map with colors based on the winning party and add EC vote labels</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> election_states_sf) <span class="sc">+</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> winning_party), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span>  <span class="co"># Color by winning party</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"REPUBLICAN"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"DEMOCRAT"</span> <span class="ot">=</span> <span class="st">"blue"</span>), </span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"REPUBLICAN"</span> <span class="ot">=</span> <span class="st">"Republican"</span>, <span class="st">"DEMOCRAT"</span> <span class="ot">=</span> <span class="st">"Democratic"</span>), </span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="st">"Winning Party"</span>) <span class="sc">+</span>  <span class="co"># Red for Republican, Blue for Democrat</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> EC), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span>  <span class="co"># Add EC vote labels</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(election_year, <span class="st">"Presidential Election: Winning Party by State"</span>)) <span class="sc">+</span>  <span class="co"># Title with dynamic year</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Explicitly print the plot</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plot)</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the years of interest and the corresponding shapefile keys</span></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1976</span>, <span class="dv">1980</span>, <span class="dv">1984</span>, <span class="dv">1988</span>, <span class="dv">1992</span>, <span class="dv">1996</span>, <span class="dv">2000</span>, <span class="dv">2004</span>, <span class="dv">2008</span>, <span class="dv">2012</span>)</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>shapefile_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"districts094.shp"</span>, <span class="st">"districts096.shp"</span>, <span class="st">"districts098.shp"</span>, <span class="st">"districts100.shp"</span>, <span class="st">"districts102.shp"</span>, </span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"districts104.shp"</span>, <span class="st">"districts106.shp"</span>, <span class="st">"districts108.shp"</span>, <span class="st">"districts110.shp"</span>, <span class="st">"districts112.shp"</span>)</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each year and plot the map</span></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(years)) {</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_election_map</span>(years[i], shapefile_keys[i])</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/bq/05hlr9wx4v77q56gl3760zf40000gn/T//RtmpNnwCVd/downloaded_packages</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/bq/05hlr9wx4v77q56gl3760zf40000gn/T//RtmpNnwCVd/downloaded_packages</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/bq/05hlr9wx4v77q56gl3760zf40000gn/T//RtmpNnwCVd/downloaded_packages</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/bq/05hlr9wx4v77q56gl3760zf40000gn/T//RtmpNnwCVd/downloaded_packages</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/bq/05hlr9wx4v77q56gl3760zf40000gn/T//RtmpNnwCVd/downloaded_packages</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-9-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/bq/05hlr9wx4v77q56gl3760zf40000gn/T//RtmpNnwCVd/downloaded_packages</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-9-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/bq/05hlr9wx4v77q56gl3760zf40000gn/T//RtmpNnwCVd/downloaded_packages</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-9-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/bq/05hlr9wx4v77q56gl3760zf40000gn/T//RtmpNnwCVd/downloaded_packages</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-9-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/bq/05hlr9wx4v77q56gl3760zf40000gn/T//RtmpNnwCVd/downloaded_packages</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-9-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/bq/05hlr9wx4v77q56gl3760zf40000gn/T//RtmpNnwCVd/downloaded_packages</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-9-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="task-7" class="level2">
<h2 class="anchored" data-anchor-id="task-7">Task 7:</h2>
<p>State-Wide Winner-Take-All:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for presidential winner each state and relevant years</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>vote_data <span class="ot">&lt;-</span> president_1976_2022 <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1976</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2020</span>, office <span class="sc">==</span> <span class="st">"US PRESIDENT"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, state) <span class="sc">|&gt;</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(candidatevotes <span class="sc">==</span> <span class="fu">max</span>(candidatevotes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">winner =</span> <span class="fu">first</span>(candidate),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">party =</span> <span class="fu">first</span>(party_simplified),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">highest_votes =</span> <span class="fu">max</span>(candidatevotes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>District-Wide Winner-Take-All + State-Wide “At Large” Votes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>result_data <span class="ot">&lt;-</span> president_1976_2022 <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(office <span class="sc">==</span> <span class="st">"US PRESIDENT"</span>, year <span class="sc">%in%</span> <span class="fu">seq</span>(<span class="dv">1976</span>, <span class="dv">2020</span>, <span class="at">by =</span> <span class="dv">4</span>))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>highest_votes_per_party <span class="ot">&lt;-</span> result_data <span class="sc">|&gt;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, state, party_simplified) <span class="sc">|&gt;</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_votes =</span> <span class="fu">sum</span>(candidatevotes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the winning party for each state and year based on the highest votes</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>state_winners_atlarge <span class="ot">&lt;-</span> highest_votes_per_party <span class="sc">|&gt;</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, state) <span class="sc">|&gt;</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(total_votes <span class="sc">==</span> <span class="fu">max</span>(total_votes)) <span class="sc">|&gt;</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>MIT Election Data and Science Lab, 2017, “U.S. House 1976–2022”, https://doi.org/10.7910/DVN/IG0UN2, Harvard Dataverse, V13, UNF:6:Ky5FkettbvohjTSN/IVldA== [fileUNF]<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>MIT Election Data and Science Lab, 2017, “U.S. President 1976–2020”, https://doi.org/10.7910/DVN/42MVDX, Harvard Dataverse, V8, UNF:6:F0opd1IRbeYI9QyVfzglUw== [fileUNF]<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/haolinnn\.github\.io\/STA9750-2024-FALL\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>